<% if current_user.wallets.present? %>
  <button type='button' class='btn btn-dark mb-3' data-bs-toggle='modal' data-bs-target='#AddTransaction'>
  Add Transaction
  </button>
<% else %>
  <%= link_to 'Create wallet', new_wallet_path, class: 'btn btn-dark' %>
<% end %>

<div class='modal fade text-center' id='AddTransaction' tabindex='-1' aria-labelledby='AddTransactionLabel' aria-hidden='true'>
  <div class='modal-dialog modal-lg mx-auto my-4'>
    <div class='modal-content'>
      <div class='modal-header'>
        <h5 class='modal-title' id='AddTransactionLabel'>Add transaction</h5>
        <button type='button' class='btn-close' data-bs-dismiss='modal' aria-label='Close'></button>
      </div>
      <div class='modal-body mx-5'>
        <%= form_with url: transactions_path, method: :post, class: 'm-auto px-4 pt-4 my-4 border', data: { controller: 'transactions', turbo_frame: 'transactions' } do |f| %>
          <% if @transaction %>
            <% @transaction.errors.full_messages.each do |msg| %>
              <div class='alert alert-dark mx-auto mb-4 mt-3'>
                <%= msg %>
              </div>
            <% end %>
          <% end %>
          <div class='row justify-content-center mb-4'>
            <div class='col-5'>
              <span class='border-bottom m-auto d-block'>Wallet</span>
              <div class='d-flex border-bottom'>
                <img src='https://img.icons8.com/doodle/48/000000/wallet--v1.png'/>
                <%= f.select(:wallet_id, options_for_select(current_user.wallets.map { |wallet| [wallet.name, wallet.id] }), {}, { class: 'form-select shadow-none text-center border-0' }) %>
              </div>
            </div>

            <div class='col-5'>
              <span class='border-bottom m-auto d-block'>Amount</span>
              <div class='d-flex border-bottom'>
                <img src='https://img.icons8.com/doodle/48/000000/coins--v1.png'/>
                <%= f.number_field :amount, value: 0, min: 0, class: 'form-control text-cetner border-0 text-center' %>
              </div>
            </div>
          </div>

          <%= f.label :transaction_type %>
          <%= f.select(:transaction_type, Transaction::TYPES, {}, { class: 'form-control text-center mb-4' }) %>

          <%= f.label :category %>
          <%= f.select(:category_id, options_for_select(@categories.map { |category| [category.title, category.id] }), {}, { class: 'form-control text-center mb-4' }) %>

          <%= f.label :note %>
          <%= f.text_area :note, class: 'form-control mb-4 text-center' %>

          <div class='modal-footer justify-content-center'>
            <%= f.submit 'Create', class: 'btn btn-secondary', data: { action: 'transactions#search', turbo_frame: 'transactions', 'bs-dismiss': 'modal' } %>
            <button type='button' class='btn btn-secondary' data-bs-dismiss='modal' data-action="click->transactions#reset" turbo-frame='transactions'>Close</button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
